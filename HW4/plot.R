library(ggplot2)



ggplot() + geom_point(aes(x=seq(15:25), y = Q31)) + 
  xlab("S0") + 
  ylab("Call option Price")

x = c(10, 20, 40, 80, 100, 200,500)
Q1.1 = c (3.76993,3.72605,3.72604,3.72677,3.7209,3.7242,3.72372)
Q1.2 = c (3.75764,3.70253,3.73282,3.71777,3.7238,3.72255,3.7209)
Q1.3 = c(3.75416,3.70079,3.73199,3.71745,3.72367,3.72216,3.72157)
Q1.4 = c(3.76389,3.72307,3.72474,3.72615,3.72102,3.72413,3.72268)

ggplot() + geom_point(aes(x,Q1.1,col = "1")) + geom_line(aes(x,Q1.1,col = "1"))+
  geom_point(aes(x,Q1.2,col = "2")) +  geom_line(aes(x,Q1.2,col = "2")) + 
  geom_point(aes(x,Q1.3,col = "3")) +  geom_line(aes(x,Q1.3,col = "3")) +
  geom_point(aes(x,Q1.4,col = "4")) +  geom_line(aes(x,Q1.4,col = "4"))
  



# Question 2 


library(readr)
library(quantmod)
library(DataAnalytics)
GOOG <- read_csv("GOOG.csv")


k = sd(log(GOOG$`Adj Close`/back(GOOG$`Adj Close`))[-1])

vol = sqrt(252) *k

# Question 3 

delta = c(1.327e-13,3.03377e-11,3.81487e-09,1.38845e-07,2.49998e-06,3.26114e-05,0.000245568,0.00145092,0.00564274,0.0182748,0.0497229,0.102489,0.18726,0.305068,0.423568,0.561881,0.690639,0.775313,0.857711,0.912237,0.949192,0.970125,0.984478,0.992298,0.994205,1.00098,1.00088,0.998306,1.00031,0.998592,1.00012)
delta_t = -c(0.18517,0.267883,0.295044,0.314656,0.344249,0.361537,0.377976,0.38936,0.397313,0.405762,0.414494,0.418944,0.424057,0.429953,0.434135,0.439663,0.443535,0.448982,0.454386,0.456346,0.457457,0.458331,0.459618,0.462646,0.466698,0.470195,0.474212,0.476159,0.478786,0.481927,0.485465,0.489217,0.492084,0.494479,0.495846,0.496947,0.497582,0.498538)
theta = -c(1.56174e-10,1.36231e-08,5.38867e-07,1.15259e-05,0.000149207,0.00126158,0.00757765,0.0338422,0.116761,0.321628,0.726177,1.36303,2.17663,3.00431,3.65995,3.99007,3.9839,3.70048,3.27124,2.81397,2.40612,2.08376,1.85173,1.69812,1.60001,1.54078,1.50673,1.48722,1.4764,1.47034,1.46685) 
Gamma = -c(-1.01266e-13,-1.98492e-11,-1.40677e-09,-4.48467e-08,-7.76052e-07,-7.66887e-06,-5.38793e-05,-0.000221933,-0.000858414,-0.00211848,-0.0039464,-0.00673661,-0.00976875,-0.0121572,-0.0132473,-0.0130251,-0.0110963,-0.00884831,-0.0064218,-0.00495791,-0.00279665,-0.00164509,-0.000948906,-0.000495911,-0.000326633,-0.000162125,-8.58307e-05,-2.14577e-05,1.90735e-05,9.53674e-06,2.38419e-05)
Vega = c(4.05174e-11,6.98012e-09,4.77185e-07,1.57098e-05,0.000281025,0.00302479,0.0217258,0.108369,0.399464,1.1399,2.57622,4.7726,7.48669,10.0276,11.7501,12.3259,11.6039,9.96678,7.87389,5.77888,3.97234,2.58203,1.58162,0.935173,0.526047,0.283146,0.153637,0.0752449,0.0336647,0.0164986,0.0124931)
Rho = c(3.94924e-14,3.92388e-11,6.82559e-09,4.74493e-07,1.14941e-05,0.000187971,0.00167775,0.0116131,0.0509633,0.185625,0.528058,1.23417,2.42353,4.13601,6.31185,8.70795,11.0865,13.2113,14.9791,16.3009,17.2663,17.889,18.2796,18.5145,18.6462,18.7139,18.7496,18.7613,18.7668,18.7656,18.7634)

x = seq(20,80,2)
t=  seq(0,0.37, 0.01)

ggplot() + geom_point(aes(x,Rho,col = "Rho")) + xlab("S0")
ggplot() + geom_point(aes(t,delta_t,col = "Delta")) 


# Question 4 

x = seq(80,120,4)
american = c (21.3315,18.4433,15.8854,13.6339,11.6348,9.86211,8.3883,7.07411,5.94203,5.00569,4.15542)
european = c(19.6886,17.1297,14.8403,12.814,10.9865,9.3309,7.97808,6.75155,5.67737,4.80299,3.98923)
ggplot() + geom_point(aes(x,american,col = "American")) +
  geom_point(aes(x,european,col = "European")) 
  

#Question 5 
x = c(10, 15, 20, 40, 70, 80, 100, 200 , 500 )
method_a = c(3.73015,3.71196,3.69901,3.72541,3.72046,3.71722,3.72148,3.72108,3.72183)
method_b = c(3.73677,3.71638,3.70235,3.72706,3.7214,3.71808,3.72206,3.72132,3.72191)
ggplot() + geom_point(aes(x,method_a,col = "Method_a")) +
  geom_line(aes(x,method_a,col = "Method_a"))+
  geom_point(aes(x,method_b,col = "Method_b"))+
  geom_line(aes(x,method_b,col = "Method_b"))+
  ylab("Option price")+
  xlab("Number of layers")
  


